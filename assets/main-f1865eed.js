import{b as l}from"./init-efdab3ca.js";let n;const u=[{zone:"fireplacezone",message:"Hey! Is this office cold?",cta:[{label:"Yes",className:"primary",callback:()=>{WA.room.showLayer("others/fire")}},{label:"No",className:"primary",callback:()=>{WA.room.hideLayer("others/fire")}}]}];function p(e,o){const t=u.find(r=>r.zone==e);typeof t<"u"&&(n=WA.ui.openPopup(o,t.message,t.cta))}function d(){typeof n!==void 0&&(n.close(),n=void 0)}function f(e,o){let r=new Date().getHours();r>=17&&r<=6?(WA.room.hideLayer(e),WA.room.showLayer(o)):(WA.room.hideLayer(o),WA.room.showLayer(e))}let s="https://admin.workadventu.re";function c(){const e=WA.player.userRoomToken;if(e===void 0)throw new Error("No userRoomToken found. The quests plugin can only work with WorkAdventure SAAS edition (at https://play.workadventu.re).");return e}async function h(e,o){if(!WA.player.isLogged)throw new Error("You must be logged to gain XP.");const t=new URL(`/api/quests/${e}/level-up`,s),r=await fetch(t,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:c()},body:JSON.stringify({xp:o})});if(!r.ok)throw new Error(`An error occurred. HTTP Code: ${r.status} ${r.statusText}.`);const a=await r.json();return a.awardedBadges.length>0&&(async()=>{for(const i of a.awardedBadges)await m(e,i)})().catch(i=>{console.error(i)}),a}async function m(e,o){const t=new URL(`/quests/${e}/badge/${o}/congratulations`,s);t.search=new URLSearchParams({token:c()}).toString(),await WA.ui.website.open({url:t.toString(),position:{vertical:"middle",horizontal:"middle"},allowApi:!0,visible:!0,size:{width:"100%",height:"100%"}})}console.log("Script started successfully");WA.onInit().then(()=>{WA.player.tags.includes("team")&&WA.player.setOutlineColor(0,119,141);let e;WA.room.area.onEnter("fireplacezone").subscribe(()=>{e="fireplacezone",p(e,e+"Popup")}),h("Up-time-meta",1),WA.room.area.onLeave("fireplacezone").subscribe(()=>{d()}),f("",""),l().then(()=>{console.log("Scripting API Extra ready")}).catch(o=>console.error(o))}).catch(e=>console.error(e));
//# sourceMappingURL=main-f1865eed.js.map
